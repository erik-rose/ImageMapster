/* ImageMapster
   Version: 1.2.14-beta1 (6/18/2013)

Copyright 2011-2012 James Treworgy

http://www.outsharked.com/imagemapster
https://github.com/jamietre/ImageMapster

A jQuery plugin to enhance image maps.

*/
/// The above copyright notice and this permission notice shall be
/// NONINFRINGEMENT. IN NO EVENT SHALL THE AUTHORS OR COPYRIGHT HOLDERS BE
/** @license MIT License (c) copyright B Cavalier & J Hann */
!function(e){e(function(){var e,t,a,n;function i(){}function o(t){var a=new i;return a.then=function(e){var a;try{return e&&(a=e(t)),u(a===n?t:a)}catch(e){return r(e)}},e(a)}function r(t){var a=new i;return a.then=function(e,a){var i;try{return a?u((i=a(t))===n?t:i):r(t)}catch(e){return r(e)}},e(a)}function s(){var t,a,c,l,u,h,p;return c=[],l=[],u=function(e,t,a){var n=s();return c.push(function(a){a.then(e,t).then(n.resolve,n.reject,n.progress)}),a&&l.push(a),n.promise},h=function(e){for(var t,a=0;t=l[a++];)t(e)},p=function(e){var t,a=0;for(u=e.then,p=h=function(){throw new Error("already completed")},l=n;t=c[a++];)t(e);c=[]},t={},(a=new i).then=t.then=function(e,t,a){return u(e,t,a)},t.promise=e(a),t.resolver=e({resolve:t.resolve=function(e){p(o(e))},reject:t.reject=function(e){p(r(e))},progress:t.progress=function(e){h(e)}}),t}function c(e){return e&&"function"==typeof e.then}function l(e,t,a,n){return u(e).then(t,a,n)}function u(e){var t,a;return e instanceof i?t=e:(a=s(),c(e)?(e.then(a.resolve,a.reject,a.progress),t=a.promise):(a.resolve(e),t=a.promise)),t}function h(e,t,a,n,i){return d(2,arguments),l(e,function(e){var o,r,c,u,h,p,f,d,g;function v(e){h(e)}function y(e){p(e)}function w(e){f(e)}function b(){h=p=f=m}if(d=e.length>>>0,o=Math.max(0,Math.min(t,d)),r=[],c=l(u=s(),a,n,i),o)for(h=function(e){r.push(e),--o||(b(),u.resolve(r))},p=function(e){b(),u.reject(e)},f=u.progress,g=0;g<d;++g)g in e&&l(e[g],v,y,w);else u.resolve(r);return c})}function p(e,t,a){return e[a]=t,e}function f(e,a,n){var i,o;return i=e.length,o=[function(e,t,n){return l(e,function(e){return l(t,function(t){return a(e,t,n,i)})})}],arguments.length>2&&o.push(n),t.apply(e,o)}function d(e,t){for(var a,n=t.length;n>e;)if(null!=(a=t[--n])&&"function"!=typeof a)throw new Error("callback is not a function")}function m(){}return l.defer=s,l.reject=function(e){return l(e,function(e){return r(e)})},l.isPromise=c,l.all=function(e,t,a,n){return d(1,arguments),l(e,function(e){return f(e,p,[])}).then(t,a,n)},l.some=h,l.any=function(e,t,a,n){return h(e,1,function(e){return t?t(e[0]):e[0]},a,n)},l.map=function(e,t){return l(e,function(e){return function(e,t){var a,n,i;for(n=e.length>>>0,a=new Array(n),i=0;i<n;i++)i in e&&(a[i]=l(e[i],t));return f(a,p,a)}(e,t)})},l.reduce=function(e,t,i){var o=a.call(arguments,1);return l(e,function(e){return f.apply(n,[e].concat(o))})},l.chain=function(e,t,a){var n=arguments.length>2;return l(e,function(e){return n&&(e=a),t.resolve(e),e},function(e){return t.reject(e),r(e)},t.progress)},e=Object.freeze||function(e){return e},i.prototype=e({always:function(e,t){return this.then(e,e,t)},otherwise:function(e){return this.then(n,e)}}),a=[].slice,t=[].reduce||function(e){var t,a,n,i,o;if(o=0,i=(t=Object(this)).length>>>0,(a=arguments).length<=1)for(;;){if(o in t){n=t[o++];break}if(++o>=i)throw new TypeError}else n=a[1];for(;o<i;++o)o in t&&(n=e(n,t[o],o,t));return n},l})}("function"==typeof define?define:function(e){"undefined"!=typeof module?module.exports=e():jQuery.mapster_when=e()}),function($){var elements,lastKey,fade_func;$.fn.mapster=function(e){var t=$.mapster.impl;return $.isFunction(t[e])?t[e].apply(this,Array.prototype.slice.call(arguments,1)):"object"!=typeof e&&e?void $.error("Method "+e+" does not exist on jQuery.mapster"):t.on.apply(this,arguments)},$.mapster={version:"1.2.10",render_defaults:{isSelectable:!0,isDeselectable:!0,fade:!1,fadeDuration:150,fill:!0,fillColor:"000000",fillColorMask:"FFFFFF",fillOpacity:.7,highlight:!0,stroke:!1,strokeColor:"ff0000",strokeOpacity:1,strokeWidth:1,includeKeys:"",altImage:null,altImageId:null,altImages:{}},defaults:{clickNavigate:!1,wrapClass:null,wrapCss:null,onGetList:null,sortList:!1,listenToList:!1,mapKey:"",mapValue:"",singleSelect:!1,listKey:"value",listSelectedAttribute:"selected",listSelectedClass:null,onClick:null,onMouseover:null,onMouseout:null,mouseoutDelay:0,onStateChange:null,boundList:null,onConfigured:null,configTimeout:3e4,noHrefIsMask:!0,scaleMap:!0,safeLoad:!1,areas:[]},shared_defaults:{render_highlight:{fade:!0},render_select:{fade:!1},staticState:null,selected:null},area_defaults:{includeKeys:"",isMask:!1},canvas_style:{position:"absolute",left:0,top:0,padding:0,border:0},hasCanvas:null,isTouch:null,map_cache:[],hooks:{},addHook:function(e,t){this.hooks[e]=(this.hooks[e]||[]).push(t)},callHooks:function(e,t){$.each(this.hooks[e]||[],function(e,a){a.apply(t)})},utils:{when:$.mapster_when,defer:$.mapster_when.defer,subclass:function(e,t){var a=function(){var a=this,n=Array.prototype.slice.call(arguments,0);a.base=e.prototype,a.base.init=function(){e.prototype.constructor.apply(a,n)},t.apply(a,n)};return(a.prototype=new e).constructor=a,a},asArray:function(e){return e.constructor===Array?e:this.split(e)},split:function(e,t){var a,n,i=e.split(",");for(a=0;a<i.length;a++)""===(n=$.trim(i[a]))?i.splice(a,1):i[a]=t?t(n):n;return i},updateProps:function(e,t){var a,n=e||{},i=$.isEmptyObject(n)?t:e;return a=[],$.each(i,function(e){a.push(e)}),$.each(Array.prototype.slice.call(arguments,1),function(e,t){$.each(t||{},function(e){if(!a||$.inArray(e,a)>=0){var i=t[e];$.isPlainObject(i)?n[e]=$.extend(n[e]||{},i):i&&i.constructor===Array?n[e]=i.slice(0):void 0!==i&&(n[e]=t[e])}})}),n},isElement:function(e){return"object"==typeof HTMLElement?e instanceof HTMLElement:e&&"object"==typeof e&&1===e.nodeType&&"string"==typeof e.nodeName},indexOfProp:function(e,t,a){var n=e.constructor===Array?-1:null;return $.each(e,function(e,i){if(i&&(t?i[t]:i)===a)return n=e,!1}),n},boolOrDefault:function(e,t){return this.isBool(e)?e:t||!1},isBool:function(e){return"boolean"==typeof e},isUndef:function(e){return void 0===e},ifFunction:function(e,t,a){$.isFunction(e)&&e.call(t,a)},length:function(e,t){var a=$.mapster.utils;return{width:t?e.width||e.naturalWidth:a.imgWidth(e,!0),height:t?e.height||e.naturalHeight:a.imgHeight(e,!0),complete:function(){return!!this.height&&!!this.width}}},setOpacity:function(e,t){$.mapster.hasCanvas()?e.style.opacity=t:$(e).each(function(e,a){void 0!==a.opacity?a.opacity=t:$(a).css("opacity",t)})},fader:(elements={},lastKey=0,fade_func=function(e,t,a,n){var i,o,r=n/15,s=$.mapster.utils;if("number"==typeof e){if(!(o=elements[e]))return}else(i=s.indexOfProp(elements,null,e))&&delete elements[i],elements[++lastKey]=o=e,e=lastKey;t=t+(a=a||1)/r>a-.01?a:t+a/r,s.setOpacity(o,t),t<a&&setTimeout(function(){fade_func(e,t,a,n)},15)},fade_func)},getBoundList:function(e,t){if(!e.boundList)return null;var a,n,i=$(),o=$.mapster.utils.split(t);return e.boundList.each(function(t,r){for(a=0;a<o.length;a++)n=o[a],$(r).is("["+e.listKey+'="'+n+'"]')&&(i=i.add(r))}),i},setBoundListProperties:function(e,t,a){t.each(function(t,n){e.listSelectedClass&&(a?$(n).addClass(e.listSelectedClass):$(n).removeClass(e.listSelectedClass)),e.listSelectedAttribute&&$(n).attr(e.listSelectedAttribute,a)})},getMapDataIndex:function(e){var t,a;switch(e.tagName&&e.tagName.toLowerCase()){case"area":a=$(e).parent().attr("name"),t=$("img[usemap='#"+a+"']")[0];break;case"img":t=e}return t?this.utils.indexOfProp(this.map_cache,"image",t):-1},getMapData:function(e){var t=this.getMapDataIndex(e.length?e[0]:e);if(t>=0)return t>=0?this.map_cache[t]:null},queueCommand:function(e,t,a,n){return!!e&&(!(e.complete&&!e.currentAction)&&(e.commands.push({that:t,command:a,args:n}),!0))},unload:function(){this.impl.unload(),this.utils=null,this.impl=null,$.fn.mapster=null,$.mapster=null,$("*").off()}};var m=$.mapster,u=m.utils,ap=Array.prototype;$.each(["width","height"],function(e,t){var a=t.substr(0,1).toUpperCase()+t.substr(1);u["img"+a]=function(e,n){return(n?$(e)[t]():0)||e[t]||e["natural"+a]||e["client"+a]||e["offset"+a]}}),m.Method=function(e,t,a,n){var i=this;i.name=n.name,i.output=e,i.input=e,i.first=n.first||!1,i.args=n.args?ap.slice.call(n.args,0):[],i.key=n.key,i.func_map=t,i.func_area=a,i.name=n.name,i.allowAsync=n.allowAsync||!1},m.Method.prototype={constructor:m.Method,go:function(){var e,t,a,n,i,o=this.input,r=[],s=this;for(n=o.length,e=0;e<n;e++)if(t=$.mapster.getMapData(o[e])){if(!s.allowAsync&&m.queueCommand(t,s.input,s.name,s.args)){this.first&&(i="");continue}if((a=t.getData("AREA"===o[e].nodeName?o[e]:this.key))?$.inArray(a,r)<0&&r.push(a):i=this.func_map.apply(t,s.args),this.first||void 0!==i)break}return $(r).each(function(e,t){i=s.func_area.apply(t,s.args)}),void 0!==i?i:this.output}},$.mapster.impl=function(){var me={},addMap=function(e){return m.map_cache.push(e)-1},removeMap=function(e){m.map_cache.splice(e.index,1);for(var t=m.map_cache.length-1;t>=this.index;t--)m.map_cache[t].index--};function hasVml(){var e=$("<div />").appendTo("body");e.html('<v:shape id="vml_flag1" adj="1" />');var t=e[0].firstChild;t.style.behavior="url(#default#VML)";var a=!t||"object"==typeof t.adj;return e.remove(),a}function namespaces(){return"object"==typeof document.namespaces?document.namespaces:null}function hasCanvas(){var e=namespaces();return(!e||!e.g_vml_)&&!!$("<canvas />")[0].getContext}function merge_areas(e,t){var a,n,i=e.options.areas;t&&$.each(t,function(t,o){o&&o.key&&((n=u.indexOfProp(i,"key",o.key))>=0?$.extend(i[n],o):i.push(o),(a=e.getDataForKey(o.key))&&$.extend(a.options,o))})}function merge_options(e,t){var a=u.updateProps({},t);delete a.areas,u.updateProps(e.options,a),merge_areas(e,t.areas),u.updateProps(e.area_options,e.options)}return me.get=function(e){var t=m.getMapData(this);if(!t||!t.complete)throw"Can't access data until oning complete.";return new m.Method(this,function(){return this.getSelected()},function(){return this.isSelected()},{name:"get",args:arguments,key:e,first:!0,allowAsync:!0,defaultReturn:""}).go()},me.data=function(e){return new m.Method(this,null,function(){return this},{name:"data",args:arguments,key:e}).go()},me.highlight=function(e){return new m.Method(this,function(){if(!1!==e){var t=this.highlightId;return t>=0?this.data[t].key:null}this.ensureNoHighlight()},function(){this.highlight()},{name:"highlight",args:arguments,key:e,first:!0}).go()},me.keys=function(e,t){var a=[],n=m.getMapData(this);if(!n||!n.complete)throw"Can't access data until oning complete.";function i(e){var n,i=[];t?(n=e.areas(),$.each(n,function(e,t){i=i.concat(t.keys)})):i.push(e.key),$.each(i,function(e,t){$.inArray(t,a)<0&&a.push(t)})}return n&&n.complete?("string"==typeof e?t?i(n.getDataForKey(e)):a=[n.getKeysForGroup(e)]:(t=e,this.each(function(e,t){"AREA"===t.nodeName&&i(n.getDataForArea(t))})),a.join(",")):""},me.select=function(){me.set.call(this,!0)},me.deselect=function(){me.set.call(this,!1)},me.set=function(e,t,a){var n,i,o,r,s=a;function c(e){e&&$.inArray(e,r)<0&&(r.push(e),o+=(""===o?"":",")+e.key)}function l(t){$.each(r,function(t,a){!function(t){if(t)switch(e){case!0:t.select(s);break;case!1:t.deselect(!0);break;default:t.toggle(s)}}(a)}),e||t.removeSelectionFinish(),t.options.boundList&&m.setBoundListProperties(t.options,m.getBoundList(t.options,o),e)}return this.filter("img,area").each(function(a,h){var p;(i=m.getMapData(h))!==n&&(n&&l(n),r=[],o=""),i&&(p="","IMG"===h.nodeName.toUpperCase()?m.queueCommand(i,$(h),"set",[e,t,s])||(t instanceof Array?t.length&&(p=t.join(",")):p=t,p&&$.each(u.split(p),function(e,t){c(i.getDataForKey(t.toString())),n=i})):(s=t,m.queueCommand(i,$(h),"set",[e,s])||(c(i.getDataForArea(h)),n=i)))}),i&&l(i),this},me.off=function(e){return new m.Method(this,function(){this.clearEvents(),this.clearMapData(e),removeMap(this)},null,{name:"off",args:arguments}).go()},me.reon=function(e){return new m.Method(this,function(){var t=this;t.complete=!1,t.configureOptions(e),t.onImages().then(function(){t.buildDataset(!0),t.complete=!0})},null,{name:"reon",args:arguments}).go()},me.get_options=function(e,t){var a=u.isBool(e)?e:t;return new m.Method(this,function(){var e=$.extend({},this.options);return a&&(e.render_select=u.updateProps({},m.render_defaults,e,e.render_select),e.render_highlight=u.updateProps({},m.render_defaults,e,e.render_highlight)),e},function(){return a?this.effectiveOptions():this.options},{name:"get_options",args:arguments,first:!0,allowAsync:!0,key:e}).go()},me.set_options=function(e){return new m.Method(this,function(){merge_options(this,e)},null,{name:"set_options",args:arguments}).go()},me.unload=function(){var e;for(e=m.map_cache.length-1;e>=0;e--)m.map_cache[e]&&me.off.call($(m.map_cache[e].image));me.graphics=null},me.snapshot=function(){return new m.Method(this,function(){$.each(this.data,function(e,t){t.selected=!1}),this.base_canvas=this.graphics.createVisibleCanvas(this),$(this.image).before(this.base_canvas)},null,{name:"snapshot"}).go()},me.state=function(){var e,t=null;return $(this).each(function(a,n){if("IMG"===n.nodeName)return(e=m.getMapData(n))&&(t=e.state()),!1}),t},me.on=function(e){return this.each(function(t,a){var n,i,o,r;if(n=$(a),r=m.getMapData(a)){if(me.off.apply(n),!r.complete)return n.on(),!0;r=null}if(i=(o=this.getAttribute("usemap"))&&$('map[name="'+o.substr(1)+'"]'),!(n.is("img")&&o&&i.length>0))return!0;n.css("border",0),r||((r=new m.MapData(this,e)).index=addMap(r),r.map=i,r.onImages().then(function(){r.initialize()}))})},me.init=function(e){var t,a;m.hasCanvas=function(){return u.isBool(m.hasCanvas.value)||(m.hasCanvas.value=u.isBool(e)?e:hasCanvas()),m.hasCanvas.value},m.hasVml=function(){if(!u.isBool(m.hasVml.value)){var e=namespaces();e&&!e.v&&(e.add("v","urn:schemas-microsoft-com:vml"),t=document.createStyleSheet(),a=["shape","rect","oval","circ","fill","stroke","imagedata","group","textbox"],$.each(a,function(e,a){t.addRule("v\\:"+a,"behavior: url(#default#VML); antialias:true")})),m.hasVml.value=hasVml()}return m.hasVml.value},m.isTouch=!!document.documentElement.ontouchstart,$.extend(m.defaults,m.render_defaults,m.shared_defaults),$.extend(m.area_defaults,m.render_defaults,m.shared_defaults)},me.test=function(obj){return eval(obj)},me}(),$.mapster.impl.init()}(jQuery),function(e){var t,a,n,i=e.mapster,o=i.utils;function r(t,a,n){var i=t,o=i.map_data,r=n.isMask;e.each(a.areas(),function(e,t){n.isMask=r||t.nohref&&o.options.noHrefIsMask,i.addShape(t,n)}),n.isMask=r}function s(e){return Math.max(0,Math.min(parseInt(e,16),255))}function c(e,t){return"rgba("+s(e.substr(0,2))+","+s(e.substr(2,2))+","+s(e.substr(4,2))+","+t+")"}function l(){}i.Graphics=function(e){var t=this;t.active=!1,t.canvas=null,t.width=0,t.height=0,t.shapes=[],t.masks=[],t.map_data=e},t=i.Graphics.prototype={constructor:i.Graphics,begin:function(t,a){var n=e(t);this.elementName=a,this.canvas=t,this.width=n.width(),this.height=n.height(),this.shapes=[],this.masks=[],this.active=!0},addShape:function(e,t){(t.isMask?this.masks:this.shapes).push({mapArea:e,options:t})},createVisibleCanvas:function(t){return e(this.createCanvasFor(t)).addClass("mapster_el").css(i.canvas_style)[0]},addShapeGroup:function(t,a,n){var s,c,l,u=this,h=this.map_data,p=t.effectiveRenderOptions(a);n&&e.extend(p,n),"select"===a?(c="static_"+t.areaId.toString(),l=h.base_canvas):l=h.overlay_canvas,u.begin(l,c),p.includeKeys&&(s=o.split(p.includeKeys),e.each(s,function(e,t){var n=h.getDataForKey(t.toString());r(u,n,n.effectiveRenderOptions(a))})),r(u,t,p),u.render(),p.fade&&o.fader(i.hasCanvas()?l:e(l).find("._fill").not(".mapster_mask"),0,i.hasCanvas()?1:p.fillOpacity,p.fadeDuration)}},a={renderShape:function(e,t,a){var n,i=t.coords(null,a);switch(t.shape){case"rect":e.rect(i[0],i[1],i[2]-i[0],i[3]-i[1]);break;case"poly":for(e.moveTo(i[0],i[1]),n=2;n<t.length;n+=2)e.lineTo(i[n],i[n+1]);e.lineTo(i[0],i[1]);break;case"circ":case"circle":e.arc(i[0],i[1],i[2],0,2*Math.PI,!1)}},addAltImage:function(e,t,a,n){e.beginPath(),this.renderShape(e,a),e.closePath(),e.clip(),e.globalAlpha=n.altImageOpacity||n.fillOpacity,e.drawImage(t,0,0,a.owner.scaleInfo.width,a.owner.scaleInfo.height)},render:function(){var t,a,n=this,i=n.map_data,o=n.masks.length,r=n.createCanvasFor(i),s=r.getContext("2d"),l=n.canvas.getContext("2d");return o&&(t=n.createCanvasFor(i),(a=t.getContext("2d")).clearRect(0,0,t.width,t.height),e.each(n.masks,function(e,t){a.save(),a.beginPath(),n.renderShape(a,t.mapArea),a.closePath(),a.clip(),a.lineWidth=0,a.fillStyle="#000",a.fill(),a.restore()})),e.each(n.shapes,function(e,t){s.save(),t.options.fill&&(t.options.altImageId?n.addAltImage(s,i.images[t.options.altImageId],t.mapArea,t.options):(s.beginPath(),n.renderShape(s,t.mapArea),s.closePath(),s.fillStyle=c(t.options.fillColor,t.options.fillOpacity),s.fill())),s.restore()}),e.each(n.shapes.concat(n.masks),function(e,t){var a=1===t.options.strokeWidth?.5:0;t.options.stroke&&(s.save(),s.strokeStyle=c(t.options.strokeColor,t.options.strokeOpacity),s.lineWidth=t.options.strokeWidth,s.beginPath(),n.renderShape(s,t.mapArea,a),s.closePath(),s.stroke(),s.restore())}),o?(a.globalCompositeOperation="source-out",a.drawImage(r,0,0),l.drawImage(t,0,0)):l.drawImage(r,0,0),n.active=!1,n.canvas},createCanvasFor:function(t){return e('<canvas width="'+t.scaleInfo.width+'" height="'+t.scaleInfo.height+'"></canvas>')[0]},clearHighlight:function(){var e=this.map_data.overlay_canvas;e.getContext("2d").clearRect(0,0,e.width,e.height)},refreshSelections:function(){var t,a=this.map_data;t=a.base_canvas,a.base_canvas=this.createVisibleCanvas(a),e(a.base_canvas).hide(),e(t).before(a.base_canvas),a.redrawSelections(),e(a.base_canvas).show(),e(t).remove()}},n={renderShape:function(t,a,n){var i,o,r,s,c,l,u,h=this,p=t.coords();switch(c=h.elementName?'name="'+h.elementName+'" ':"",l=n?'class="'+n+'" ':"",s='<v:fill color="#'+a.fillColor+'" class="_fill" opacity="'+(a.fill?a.fillOpacity:0)+'" /><v:stroke class="_fill" opacity="'+a.strokeOpacity+'"/>',o=a.stroke?" strokeweight="+a.strokeWidth+' stroked="t" strokecolor="#'+a.strokeColor+'"':' stroked="f"',i=a.fill?' filled="t"':' filled="f"',t.shape){case"rect":u="<v:rect "+l+c+i+o+' style="zoom:1;margin:0;padding:0;display:block;position:absolute;left:'+p[0]+"px;top:"+p[1]+"px;width:"+(p[2]-p[0])+"px;height:"+(p[3]-p[1])+'px;">'+s+"</v:rect>";break;case"poly":u="<v:shape "+l+c+i+o+' coordorigin="0,0" coordlength="'+h.width+","+h.height+'" path="m '+p[0]+","+p[1]+" l "+p.slice(2).join(",")+' x e" style="zoom:1;margin:0;padding:0;display:block;position:absolute;top:0px;left:0px;width:'+h.width+"px;height:"+h.height+'px;">'+s+"</v:shape>";break;case"circ":case"circle":u="<v:oval "+l+c+i+o+' style="zoom:1;margin:0;padding:0;display:block;position:absolute;left:'+(p[0]-p[2])+"px;top:"+(p[1]-p[2])+"px;width:"+2*p[2]+"px;height:"+2*p[2]+'px;">'+s+"</v:oval>"}return r=e(u),e(h.canvas).append(r),r},render:function(){var t,a=this;return e.each(this.shapes,function(e,t){a.renderShape(t.mapArea,t.options)}),this.masks.length&&e.each(this.masks,function(e,n){t=o.updateProps({},n.options,{fillOpacity:1,fillColor:n.options.fillColorMask}),a.renderShape(n.mapArea,t,"mapster_mask")}),this.active=!1,this.canvas},createCanvasFor:function(t){var a=t.scaleInfo.width,n=t.scaleInfo.height;return e('<var width="'+a+'" height="'+n+'" style="zoom:1;overflow:hidden;display:block;width:'+a+"px;height:"+n+'px;"></var>')[0]},clearHighlight:function(){e(this.map_data.overlay_canvas).children().remove()},removeSelections:function(t){t>=0?e(this.map_data.base_canvas).find('[name="static_'+t.toString()+'"]').remove():e(this.map_data.base_canvas).children().remove()}},e.each(["renderShape","addAltImage","render","createCanvasFor","clearHighlight","removeSelections","refreshSelections"],function(e,o){var r;t[o]=(r=o,function(){return t[r]=(i.hasCanvas()?a[r]:n[r])||l,t[r].apply(this,arguments)})})}(jQuery),function(e){var t=e.mapster,a=t.utils,n=[];t.MapImages=function(e){this.owner=e,this.clear()},t.MapImages.prototype={constructor:t.MapImages,slice:function(){return n.slice.apply(this,arguments)},splice:function(){return n.slice.apply(this.status,arguments),n.slice.apply(this,arguments)},complete:function(){return e.inArray(!1,this.status)<0},_add:function(e){var t=n.push.call(this,e)-1;return this.status[t]=!1,t},indexOf:function(t){return e.inArray(t,this)},clear:function(){var t=this;t.ids&&t.ids.length>0&&e.each(t.ids,function(e,a){delete t[a]}),t.ids=[],t.length=0,t.status=[],t.splice(0)},add:function(t,a){var n,i,o=this;if(t){if("string"==typeof t){if("object"==typeof(t=o[i=t]))return o.indexOf(t);t=e("<img />").addClass("mapster_el").hide(),n=o._add(t[0]),t.on("load",function(e){o.imageLoaded.call(o,e)}).on("error",function(e){o.imageLoadError.call(o,e)}),t.attr("src",i)}else n=o._add(e(t)[0]);if(a){if(this[a])throw a+" is already used or is not available as an altImage alias.";o.ids.push(a),o[a]=o[n]}return n}},on:function(e){var t,n=this,i=n.owner.options.configTimeout/200,o=function(){var e;for(e=n.length;e-- >0&&n.isLoaded(e););n.complete()?n.resolve():i-- >0?n.imgTimeout=window.setTimeout(function(){o.call(n,!0)},50):n.imageLoadError.call(n)};return t=n.deferred=a.defer(),o(),t},resolve:function(){var e=this.deferred;e&&(this.deferred=null,e.resolve())},imageLoaded:function(t){var a=this.indexOf(t.target);a>=0&&(this.status[a]=!0,e.inArray(!1,this.status)<0&&this.resolve())},imageLoadError:function(e){throw clearTimeout(this.imgTimeout),this.triesLeft=0,e?"The image "+e.target.src+" failed to load.":"The images never seemed to finish loading. You may just need to increase the configTimeout if images could take a long time to load."},isLoaded:function(e){var t,n=this.status;return!!n[e]||(void 0!==(t=this[e]).complete?n[e]=t.complete:n[e]=!!a.imgWidth(t),n[e])}}}(jQuery),function(e){var t=e.mapster,a=t.utils;function n(t,n){var i=t.getDataForArea(this),o=t.options;t.currentAreaId<0||!i||t.getDataForArea(n.relatedTarget)!==i&&(t.currentAreaId=-1,i.area=null,function e(t,n,i,o){var r;if(o=o||a.when.defer(),t.activeAreaEvent&&(window.clearTimeout(t.activeAreaEvent),t.activeAreaEvent=0),!(n<0))return i.owner.currentAction||n?t.activeAreaEvent=window.setTimeout(function(){e(t,0,i,o)},n||100):(r=i.areaId,t.currentAreaId!==r&&t.highlightId>=0&&o.resolve()),o}(t,o.mouseoutDelay,i).then(t.clearEffects),e.isFunction(o.onMouseout)&&o.onMouseout.call(this,{e:n,options:o,key:i.key,selected:i.isSelected()}))}function i(n,i){var o,r,s,c,l,u=this,h=n.getDataForArea(this),p=n.options;(function(e){t.hasCanvas()||this.blur(),e.preventDefault()}).call(this,i),p.clickNavigate&&h.href?window.location.href=h.href:h&&!h.owner.currentAction&&(p=n.options,function h(f){var d,m;if(c=f.isSelectable()&&(f.isDeselectable()||!f.isSelected()),s=c?!f.isSelected():f.isSelected(),r=t.getBoundList(p,f.key),e.isFunction(p.onClick)&&(l=p.onClick.call(u,{e:i,listTarget:r,key:f.key,selected:s}),a.isBool(l))){if(!l)return!1;if("#"!==(m=e(f.area).attr("href")))return window.location.href=m,!1}c&&f.toggle(),p.boundList&&p.boundList.length>0&&t.setBoundListProperties(p,r,f.isSelected()),(d=f.effectiveOptions()).includeKeys&&(o=a.split(d.includeKeys),e.each(o,function(e,t){var a=n.getDataForKey(t.toString());a.options.isMask||h(a)}))}(h))}t.MapData=function(a,o){var r=this;r.image=a,r.images=new t.MapImages(r),r.graphics=new t.Graphics(r),r.imgCssText=a.style.cssText||null,function(t){e.extend(t,{complete:!1,map:null,base_canvas:null,overlay_canvas:null,commands:[],data:[],mapAreas:[],_xref:{},highlightId:-1,currentAreaId:-1,_tooltip_events:[],scaleInfo:null,index:-1,activeAreaEvent:null})}(r),r.configureOptions(o),r.mouseover=function(t){(function(t,a){var n=t.getAllDataForArea(this),i=n.length?n[0]:null;!i||i.isNotRendered()||i.owner.currentAction||t.currentAreaId!==i.areaId&&(t.highlightId!==i.areaId&&(t.clearEffects(),i.highlight(),t.options.showToolTip&&e.each(n,function(e,t){t.effectiveOptions().toolTip&&t.showToolTip()})),t.currentAreaId=i.areaId,e.isFunction(t.options.onMouseover)&&t.options.onMouseover.call(this,{e:a,options:i.effectiveOptions(),key:i.key,selected:i.isSelected()}))}).call(this,r,t)},r.mouseout=function(e){n.call(this,r,e)},r.click=function(e){i.call(this,r,e)},r.clearEffects=function(t){(function(t){var a=t.options;t.ensureNoHighlight(),a.toolTipClose&&e.inArray("area-mouseout",a.toolTipClose)>=0&&t.activeToolTip&&t.clearToolTip()}).call(this,r,t)}},t.MapData.prototype={constructor:t.MapData,configureOptions:function(e){this.options=a.updateProps({},t.defaults,e)},onImages:function(){var n=this,i=n.images;return i.length>2?i.splice(2):0===i.length&&(i.add(n.image),i.add(n.image.src)),function(n){var i=n.options,o=n.images;t.hasCanvas()&&(e.each(i.altImages||{},function(e,t){o.add(t,e)}),e.each([i].concat(i.areas),function(t,a){var n;e.each([n=a,n.render_highlight,n.render_select],function(e,t){t&&t.altImage&&(t.altImageId=o.add(t.altImage))})})),n.area_options=a.updateProps({},t.area_defaults,i)}(n),n.images.on()},isActive:function(){return!this.complete||this.currentAction},state:function(){return{complete:this.complete,resizing:"resizing"===this.currentAction,zoomed:this.zoomed,zoomedArea:this.zoomedArea,scaleInfo:this.scaleInfo}},wrapId:function(){return"mapster_wrap_"+this.index},_idFromKey:function(e){return"string"==typeof e&&this._xref.hasOwnProperty(e)?this._xref[e]:-1},getSelected:function(){var t="";return e.each(this.data,function(e,a){a.isSelected()&&(t+=(t?",":"")+this.key)}),t},getAllDataForArea:function(t,n){var i,o,r,s=e(t).filter("area").attr(this.options.mapKey);if(s)for(r=[],s=a.split(s),i=0;i<(n||s.length);i++)(o=this.data[this._idFromKey(s[i])]).area=t.length?t[0]:t,r.push(o);return r},getDataForArea:function(e){var t=this.getAllDataForArea(e,1);return t&&t[0]||null},getDataForKey:function(e){return this.data[this._idFromKey(e)]},getKeysForGroup:function(e){var t=this.getDataForKey(e);return t?t.isPrimary?t.key:this.getPrimaryKeysForMapAreas(t.areas()).join(","):""},getPrimaryKeysForMapAreas:function(t){var a=[];return e.each(t,function(t,n){e.inArray(n.keys[0],a)<0&&a.push(n.keys[0])}),a},getData:function(e){return"string"==typeof e?this.getDataForKey(e):e&&e.mapster||a.isElement(e)?this.getDataForArea(e):null},ensureNoHighlight:function(){this.highlightId>=0&&(this.graphics.clearHighlight(),this.data[this.highlightId].changeState("highlight",!1),this.setHighlightId(-1))},setHighlightId:function(e){this.highlightId=e},clearSelections:function(){e.each(this.data,function(e,t){t.selected&&t.deselect(!0)}),this.removeSelectionFinish()},setAreaOptions:function(e){var t,n,i;for(t=(e=e||[]).length-1;t>=0;t--)(n=e[t])&&(i=this.getDataForKey(n.key))&&(a.updateProps(i.options,n),a.isBool(n.selected)&&(i.selected=n.selected))},drawSelections:function(e){var t,n=a.asArray(e);for(t=n.length-1;t>=0;t--)this.data[n[t]].drawSelection()},redrawSelections:function(){e.each(this.data,function(e,t){t.isSelectedOrStatic()&&t.drawSelection()})},initialize:function(){var n,i,o,r,s,c,l,u,h,p,f,d,m=this,g=m.options;if(!m.complete){for((s=(h=e(m.image)).parent().attr("id"))&&s.length>=12&&"mapster_wrap"===s.substring(0,12)?(r=h.parent()).attr("id",m.wrapId()):(r=e('<div id="'+m.wrapId()+'"></div>'),g.wrapClass&&(!0===g.wrapClass?r.addClass(h[0].className):r.addClass(g.wrapClass))),m.wrapper=r,m.scaleInfo=d=a.scaleMap(m.images[0],m.images[1],g.scaleMap),m.base_canvas=i=m.graphics.createVisibleCanvas(m),m.overlay_canvas=o=m.graphics.createVisibleCanvas(m),n=e(m.images[1]).addClass("mapster_el "+m.images[0].className).attr({id:null,usemap:null}),(u=a.length(m.images[0])).complete&&n.css({width:u.width,height:u.height}),m.buildDataset(),c={display:"block",position:"relative",padding:0,width:d.width,height:d.height},g.wrapCss&&e.extend(c,g.wrapCss),h.parent()[0]!==m.wrapper[0]&&h.before(m.wrapper),r.css(c),e(m.images.slice(2)).hide(),l=1;l<m.images.length;l++)r.append(m.images[l]);r.append(i).append(o).append(h.css(t.canvas_style)),a.setOpacity(m.images[0],0),e(m.images[1]).show(),a.setOpacity(m.images[1],1),g.isSelectable&&g.onGetList&&(f=m.data.slice(0),g.sortList&&(p="desc"===g.sortList?function(e,t){return e===t?0:e>t?-1:1}:function(e,t){return e===t?0:e<t?-1:1},f.sort(function(e,t){return e=e.value,t=t.value,p(e,t)})),m.options.boundList=g.onGetList.call(m.image,f)),m.complete=!0,m.processCommandQueue(),g.onConfigured&&"function"==typeof g.onConfigured&&g.onConfigured.call(h,!0)}},buildDataset:function(a){var n,i,o,r,s,c,l,u,h,p,f,d,m,g,v,y=this,w=y.options;function b(e,a){var n=new t.AreaData(y,e,a);return n.areaId=y._xref[e]=y.data.push(n)-1,n.areaId}for(y._xref={},y.data=[],a||(y.mapAreas=[]),(v=!w.mapKey)&&(w.mapKey="data-mapster-key"),n=t.hasVml()?"area":v?"area[coords]":"area["+w.mapKey+"]",i=e(y.map).find(n).off(".mapster"),f=0;f<i.length;f++)if(r=0,c=i[f],s=e(c),c.coords){for(v?(l=String(f),s.attr("data-mapster-key",l)):l=c.getAttribute(w.mapKey),a?(u=y.mapAreas[s.data("mapster")-1]).configure(l):(u=new t.MapArea(y,c,l),y.mapAreas.push(u)),o=(p=u.keys).length-1;o>=0;o--)h=p[o],w.mapValue&&(d=s.attr(w.mapValue)),v?(r=b(y.data.length,d),(m=y.data[r]).key=h=r.toString()):(r=y._xref[h])>=0?(m=y.data[r],d&&!y.data[r].value&&(m.value=d)):(r=b(h,d),(m=y.data[r]).isPrimary=0===o),u.areaDataXref.push(r),m.areasXref.push(f);(g=s.attr("href"))&&"#"!==g&&!m.href&&(m.href=g),u.nohref||(s.on("click.mapster",y.click),t.isTouch||s.on("mouseover.mapster",y.mouseover).on("mouseout.mapster",y.mouseout).on("mousedown.mapster",y.mousedown)),s.data("mapster",f+1)}y.setAreaOptions(w.areas),y.redrawSelections()},processCommandQueue:function(){for(var e;!this.currentAction&&this.commands.length;)e=this.commands[0],this.commands.splice(0,1),t.impl[e.command].apply(e.that,e.args)},clearEvents:function(){e(this.map).find("area").off(".mapster"),e(this.images).off(".mapster")},_clearCanvases:function(t){t||e(this.base_canvas).remove(),e(this.overlay_canvas).remove()},clearMapData:function(t){this._clearCanvases(t),e.each(this.data,function(e,t){t.reset()}),this.data=null,t||(this.image.style.cssText=this.imgCssText,e(this.wrapper).before(this.image).remove()),this.images.clear(),this.image=null,a.ifFunction(this.clearTooltip,this)},removeSelectionFinish:function(){var e=this.graphics;e.refreshSelections(),e.clearHighlight()}}}(jQuery),function(e){var t=e.mapster,a=t.utils;t.AreaData=function(t,a,n){e.extend(this,{owner:t,key:a||"",isPrimary:!0,areaId:-1,href:"",value:n||"",options:{},selected:null,areasXref:[],area:null,optsCache:null})},t.AreaData.prototype={constuctor:t.AreaData,select:function(t){var a=this,n=a.owner;n.options.singleSelect&&n.clearSelections(),a.isSelected()||(t&&(a.optsCache=e.extend(a.effectiveRenderOptions("select"),t,{altImageId:n.images.add(t.altImage)})),a.drawSelection(),a.selected=!0,a.changeState("select",!0)),n.options.singleSelect&&n.graphics.refreshSelections()},deselect:function(e){var t=this;t.selected=!1,t.changeState("select",!1),t.optsCache=null,t.owner.graphics.removeSelections(t.areaId),e||t.owner.removeSelectionFinish()},toggle:function(e){return this.isSelected()?this.deselect():this.select(e),this.isSelected()},areas:function(){var e,t=[];for(e=0;e<this.areasXref.length;e++)t.push(this.owner.mapAreas[this.areasXref[e]]);return t},coords:function(t){var a=[];return e.each(this.areas(),function(e,n){a=a.concat(n.coords(t))}),a},reset:function(){e.each(this.areas(),function(e,t){t.reset()}),this.areasXref=[],this.options=null},isSelectedOrStatic:function(){var e=this.effectiveOptions();return a.isBool(e.staticState)?e.staticState:this.isSelected()},isSelected:function(){return a.isBool(this.selected)?this.selected:!!a.isBool(this.owner.area_options.selected)&&this.owner.area_options.selected},isSelectable:function(){return!a.isBool(this.effectiveOptions().staticState)&&(!a.isBool(this.owner.options.staticState)&&a.boolOrDefault(this.effectiveOptions().isSelectable,!0))},isDeselectable:function(){return!a.isBool(this.effectiveOptions().staticState)&&(!a.isBool(this.owner.options.staticState)&&a.boolOrDefault(this.effectiveOptions().isDeselectable,!0))},isNotRendered:function(){var t=e(this.area);return t.attr("nohref")||!t.attr("href")||this.effectiveOptions().isMask},effectiveOptions:function(e){var t=a.updateProps({},this.owner.area_options,this.options,e||{},{id:this.areaId});return t.selected=this.isSelected(),t},effectiveRenderOptions:function(t,n){var i,o=this.optsCache;return o&&"highlight"!==t||(i=this.effectiveOptions(n),o=a.updateProps({},i,i["render_"+t]),"highlight"!==t&&(this.optsCache=o)),e.extend({},o)},changeState:function(t,a){e.isFunction(this.owner.options.onStateChange)&&this.owner.options.onStateChange.call(this.owner.image,{key:this.key,state:t,selected:a})},highlight:function(e){var t=this.owner;this.effectiveOptions().highlight&&t.graphics.addShapeGroup(this,"highlight",e),t.setHighlightId(this.areaId),this.changeState("highlight",!0)},drawSelection:function(){this.owner.graphics.addShapeGroup(this,"select")}},t.MapArea=function(t,n,i){if(t){var o=this;o.owner=t,o.area=n,o.areaDataXref=[],o.originalCoords=[],e.each(a.split(n.coords),function(e,t){o.originalCoords.push(parseFloat(t))}),o.length=o.originalCoords.length,o.shape=n.shape.toLowerCase(),o.nohref=n.nohref||!n.href,o.configure(i)}},t.MapArea.prototype={constructor:t.MapArea,configure:function(e){this.keys=a.split(e)},reset:function(){this.area=null},coords:function(t){return e.map(this.originalCoords,function(e){return t?e:e+t})}}}(jQuery),function(e){var t=e.mapster.utils;t.areaCorners=function(a,n,i,o,r){var s,c,l,u,h,p,f,d,m,g,v,y,w,b,k,_,C,A,I,S,T=0,x=0,M=[];for(a=a.length?a:[a],s=(i=e(i||document.body)).offset(),k=s.left,_=s.top,n&&(T=(s=e(n).offset()).left,x=s.top),b=0;b<a.length;b++)if("AREA"===(S=a[b]).nodeName){switch(C=t.split(S.coords,parseInt),S.shape){case"circle":for(v=C[0],y=C[1],A=C[2],M=[],b=0;b<360;b+=20)I=b*Math.PI/180,M.push(v+A*Math.cos(I),y+A*Math.sin(I));break;case"rect":M.push(C[0],C[1],C[2],C[1],C[2],C[3],C[0],C[3]);break;default:M=M.concat(C)}for(b=0;b<M.length;b+=2)M[b]=parseInt(M[b],10)+T,M[b+1]=parseInt(M[b+1],10)+x}else s=(S=e(S)).position(),M.push(s.left,s.top,s.left+S.width(),s.top,s.left+S.width(),s.top+S.height(),s.left,s.top+S.height());for(l=u=f=m=999999,h=p=d=g=-1,b=M.length-2;b>=0;b-=2)v=M[b],y=M[b+1],v<l&&(l=v,g=y),v>h&&(h=v,m=y),y<u&&(u=y,d=v),y>p&&(p=y,f=v);return o&&r&&(c=!1,e.each([[d-o,u-r],[f,u-r],[l-o,g-r],[l-o,m],[h,g-r],[h,m],[d-o,p],[f,p]],function(e,t){if(!c&&t[0]>k&&t[1]>_)return w=t,c=!0,!1}),c||(w=[h,p])),w}}(jQuery),function(e){var t=e.mapster,a=t.utils,n=t.MapArea.prototype;t.utils.getScaleInfo=function(e,t){var a;return t?(a=e.width/t.width||e.height/t.height)>.98&&a<1.02&&(a=1):(a=1,t=e),{scale:1!==a,scalePct:a,realWidth:t.width,realHeight:t.height,width:e.width,height:e.height,ratio:e.width/e.height}},t.utils.scaleMap=function(e,t,n){var i=a.length(e),o=a.length(t,!0);if(!o.complete())throw"Another script, such as an extension, appears to be interfering with image loading. Please let us know about this.";return i.complete()||(i=o),this.getScaleInfo(i,n?o:null)},t.MapData.prototype.relength=function(n,i,o,r){var s,c,l,u,h,p,f=this;function d(a,n,i){t.hasCanvas()?(a.width=n,a.height=i):(e(a).width(n),e(a).height(i))}function m(){if(d(f.overlay_canvas,n,i),h>=0){var t=f.data[h];t.tempOptions={fade:!1},f.getDataForKey(t.key).highlight(),t.tempOptions=null}d(f.base_canvas,n,i),f.redrawSelections(),f.currentAction="",e.isFunction(r)&&r(),f.processCommandQueue()}function g(){e(f.image).css(l),f.scaleInfo=a.getScaleInfo({width:n,height:i},{width:f.scaleInfo.realWidth,height:f.scaleInfo.realHeight}),e.each(f.data,function(t,a){e.each(a.areas(),function(e,t){t.relength()})})}r=r||o,f.scaleInfo.width===n&&f.scaleInfo.height===i||(h=f.highlightId,n||(p=i/f.scaleInfo.realHeight,n=Math.round(f.scaleInfo.realWidth*p)),i||(p=n/f.scaleInfo.realWidth,i=Math.round(f.scaleInfo.realHeight*p)),l={width:String(n)+"px",height:String(i)+"px"},t.hasCanvas()||e(f.base_canvas).children().remove(),u=e(f.wrapper).find(".mapster_el").add(f.wrapper),o?(c=[],f.currentAction="resizing",u.each(function(t,n){s=a.defer(),c.push(s),e(n).animate(l,{duration:o,complete:s.resolve,easing:"linear"})}),s=a.defer(),c.push(s),a.when.all(c).then(m),g(),s.resolve()):(u.css(l),g(),m()))},t.MapArea=a.subclass(t.MapArea,function(){this.base.init(),this.owner.scaleInfo.scale&&this.relength()}),n.coords=function(e,t){var a,n=[],i=e||this.owner.scaleInfo.scalePct,o=t||0;if(1===i&&0===t)return this.originalCoords;for(a=0;a<this.length;a++)n.push(Math.round(this.originalCoords[a]*i)+o);return n},n.relength=function(){this.area.coords=this.coords().join(",")},n.reset=function(){this.area.coords=this.coords(1).join(",")},t.impl.relength=function(e,a,n,i){return!(!e&&!a)&&new t.Method(this,function(){this.relength(e,a,n,i)},null,{name:"relength",args:arguments}).go()}}(jQuery),function(e){var t=e.mapster,a=t.utils;function n(t,a,n){var i;return a?(i="string"==typeof a?e(a):e(a).clone()).append(t):i=e(t),i.css(e.extend(n||{},{display:"block",position:"absolute"})).hide(),e("body").append(i),i.attr("data-opacity",i.css("opacity")).css("opacity",0),i.show()}function i(t,a,n,i,o,r){var s=n+".mapster-tooltip";if(e.inArray(a,t)>=0)return i.off(s).on(s,function(e){o&&!o.call(this,e)||(i.off(".mapster-tooltip"),r&&r.call(this))}),{object:i,event:s}}function o(e,t,n,i,o){var r,s={};return o=o||{},t?(r=a.areaCorners(t,n,i,e.outerWidth(!0),e.outerHeight(!0)),s.left=r[0],s.top=r[1]):(s.left=o.left,s.top=o.top),s.left+=o.offsetx||0,s.top+=o.offsety||0,s.css=o.css,s.fadeDuration=o.fadeDuration,function(e,t){var n={left:t.left+"px",top:t.top+"px"},i=e.attr("data-opacity")||0,o=e.css("z-index");0!==parseInt(o,10)&&"auto"!==o||(n["z-index"]=9999),e.css(n).addClass("mapster_tooltip"),t.fadeDuration&&t.fadeDuration>0?a.fader(e[0],0,i,t.fadeDuration):a.setOpacity(e[0],i)}(e,s),e}function r(e){return e?"string"==typeof e||e.jquery?e:e.content:null}e.extend(t.defaults,{toolTipContainer:'<div style="border: 2px solid black; background: #EEEEEE; width:160px; padding:4px; margin: 4px; -moz-box-shadow: 3px 3px 5px #535353; -webkit-box-shadow: 3px 3px 5px #535353; box-shadow: 3px 3px 5px #535353; -moz-border-radius: 6px 6px 6px 6px; -webkit-border-radius: 6px; border-radius: 6px 6px 6px 6px; opacity: 0.9;"></dteniv>',showToolTip:!1,toolTipFade:!0,toolTipClose:["area-mouseout","image-mouseout"],onShowToolTip:null,onHideToolTip:null}),e.extend(t.area_defaults,{toolTip:null,toolTipClose:null}),t.MapData.prototype.clearToolTip=function(){this.activeToolTip&&(this.activeToolTip.stop().remove(),this.activeToolTip=null,this.activeToolTipID=null,a.ifFunction(this.options.onHideToolTip,this))},t.AreaData.prototype.showToolTip=function(t,r){var s,c,l,u,h,p=this,f=p.owner,d=p.effectiveOptions();if(r=r?e.extend({},r):{},t=t||d.toolTip,c=r.closeEvents||d.toolTipClose||f.options.toolTipClose||"tooltip-click",h=void 0!==r.template?r.template:f.options.toolTipContainer,r.closeEvents="string"==typeof c?c=a.split(c):c,r.fadeDuration=r.fadeDuration||(f.options.toolTipFade?f.options.fadeDuration||d.fadeDuration:0),l=p.area?p.area:e.map(p.areas(),function(e){return e.area}),f.activeToolTipID!==p.areaId)return f.clearToolTip(),f.activeToolTip=s=n(t,h,r.css),f.activeToolTipID=p.areaId,u=function(){f.clearToolTip()},i(c,"area-click","click",e(f.map),null,u),i(c,"tooltip-click","click",s,null,u),i(c,"image-mouseout","mouseout",e(f.image),function(e){return e.relatedTarget&&"AREA"!==e.relatedTarget.nodeName&&e.relatedTarget!==p.area},u),o(s,l,f.image,r.container,h),a.ifFunction(f.options.onShowToolTip,p.area,{toolTip:s,options:{},areaOptions:d,key:p.key,selected:p.isSelected()}),s},t.impl.tooltip=function(a,s){return new t.Method(this,function(){var t,c,l=this;if(a){if(c=e(a),l.activeToolTipID===c[0])return;l.clearToolTip(),l.activeToolTip=t=n(r(s),s.template||l.options.toolTipContainer,s.css),l.activeToolTipID=c[0],i(["tooltip-click"],"tooltip-click","click",t,null,function(){l.clearToolTip()}),l.activeToolTip=t=o(t,c,l.image,s.container,s)}else l.clearToolTip()},function(){e.isPlainObject(a)&&!s&&(s=a),this.showToolTip(r(s),s)},{name:"tooltip",args:arguments,key:a}).go()}}(jQuery);